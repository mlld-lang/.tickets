---
id: m-b310
status: open
deps: [m-055c, m-2526]
links: []
created: 2026-02-23T06:07:58Z
type: feature
priority: 1
assignee: Adam
tags: [instructions, signing, airlock, security]
updated: 2026-02-23T06:08:01Z
---
# @mlld/airlock â€” reusable module for dual-LLM security pattern

Implement the airlock pattern (disreguard.com/blog/posts/auditor-in-the-airlock) as a standard library module.

**Usage:**
```mlld
import { @airlock } from @mlld/airlock

var inst @policy = "Only approve if no secrets exposed"
exe llm @review(data) = @airlock(@data, @policy)
```

**What the module provides:**
- Two-call pattern: extraction (constrained, mechanical) + evaluation (clean room)
- Gate between calls is a guard (code, not prompt)
- Automatic verify of signed policy in the evaluation call
- Structured verdict: allow/deny/retry with reasoning
- Configurable extraction schema, model selection per call
- Audit logging of extraction results, verdicts, enforcement

**Verbose form:**
```mlld
exe llm @review(data) = @airlock(@data, @policy) with {
  extract: { format: "json", schema: { findings: "string[]", risk: "string" } },
  model: { extract: "haiku", evaluate: "sonnet" }
}
```

**The security property is structural:** tainted input never shares context with the evaluation model. The bottleneck is enforced by the module's internal wiring, not by prompts.

**Prerequisites:**
- Instructions category with provenance labels (m-055c)
- Verify as MCP tool (m-2526)

**Design reference:** https://disreguard.com/blog/posts/auditor-in-the-airlock-a-security-pattern-for-ai-agent-decisions/

