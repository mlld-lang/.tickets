---
id: m-8d67
status: closed
deps: []
created: 2026-02-16T05:05:44Z
type: feature
priority: 0
assignee: Adam
updated: 2026-02-16T05:31:44Z
---
# Implement content-level guard inspection for @input

@input in guard contexts is a StructuredValue. @input.any.mx.labels.includes() works for label checking, but there is no working pattern for content-level inspection (e.g. checking if the actual text contains 'sk-' or '<script'). Content inspection is useful for defense-in-depth â€” labels can be missed, but pattern-matching data catches things regardless.

## What to do
1. Determine how to expose text content on @input for inspection. Options: @input.text, @input.content, @input[0] (array access to get text), or @input.any.text.includes()
2. Pick the pattern that's most consistent with existing StructuredValue access patterns
3. Implement it
4. Update docs: docs/user/security.md, docs/src/atoms/security/before-guards.md

## Acceptance criteria
- Guards can inspect the text content of @input (not just labels)
- Pattern is documented with working examples
- Add test cases in tests/cases/

