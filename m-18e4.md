---
id: m-18e4
status: closed
deps: []
created: 2026-02-04T23:54:32Z
type: task
priority: 0
assignee: Adam
updated: 2026-02-05T19:26:36Z
---
# Adversarial verification: Security protections

## Adversarial Verification for Security Protections Job

Verify ALL exit criteria hold by attempting to break each protection:

### Exit Criteria to Verify

1. **Secret Protection** - API keys marked secret blocked from network calls
   - Run protection-1-secret.mld, confirm MlldDenial occurs
   - Try variations: different exe labels (net:w instead of exfil), different commands
   - Confirm the secret label is what triggers the block, not something else

2. **MCP Data Restriction** - MCP-sourced data blocked from destructive operations
   - KNOWN LIMITATION: Demo uses literals which don't get src:mcp label
   - Verify the policy configuration is syntactically correct
   - Document that this protection works in principle but cannot be end-to-end tested without real MCP server

3. **PII Redaction** - PII data redacted in logs/output
   - Run protection-3-pii.mld, confirm PII is redacted
   - Verify non-PII data shows normally
   - Try variations: log directive, multiple PII patterns

4. **Clear Error Messages** - Blocked operations show detailed errors
   - Run protection-4-errors.mld, confirm detailed denial message
   - Check that message includes: blocker, rule, input labels, operation labels, reason, suggestions

### Return Format

Return a structured result with exit_criteria_results array where each criterion has PASS or FAIL.


**2026-02-05 19:26 UTC:** Friction points documented: (1) policy.sources not implemented - MCP auto-classification requires manual 'var untrusted' for now, (2) PII is blocked not redacted - matches spec intent. Neither blocks completion.
