---
id: m-744d
status: closed
deps: []
created: 2026-02-03T05:58:32Z
type: bug
priority: 2
assignee: Adam
tags: [security, env-directive, phase-3]
updated: 2026-02-03T06:18:00Z
---
# Filesystem restrictions not enforced in env blocks

The env directive allows setting fs: { read: [...], write: [...] } to restrict filesystem access, but these restrictions are NOT enforced at runtime.

Evidence:
- env.ts:140 stores the config via setScopedEnvironmentConfig()
- filesystem-policy.ts has enforceFilesystemAccess() that checks policy.allow/deny
- BUT env-based fs config is NEVER passed to the filesystem policy enforcer
- The two systems are completely disconnected

Test case: env @config [run sh { echo 'test' > tmp/file.txt }] with fs: { write: [] } successfully writes the file instead of blocking.

Impact: Security configuration is syntax-only; env filesystem restrictions provide no actual security.


**2026-02-03 06:18 UTC:** Human confirmed: 'The Docker provider already enforces fs: { read, write } â†’ maps to -v mounts with :ro for read-only'. Closing as works-as-designed for provider case.
