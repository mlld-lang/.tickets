---
id: m-4593
status: closed
deps: []
links: []
created: 2026-01-28T22:30:36Z
type: chore
priority: 2
assignee: Adam
---
# => value inside when blocks doesn't return from enclosing exe function

RESOLUTION: Not a bug - expected behavior.

The issue reported: Pattern 'when !@x [ => null ]' shows messages but continues execution after the when block. User expected early return from exe function.

INVESTIGATION FINDINGS:
- This is the expected behavior of mlld's when expressions
- 'when [...] ' as a STATEMENT inside an exe block evaluates the when expression and continues to the next statement
- The => inside the when block returns from the when expression, not from the enclosing exe function

CORRECT PATTERN for early-return-like behavior:
Use 'when first [...]' as the exe's return expression:

  # Instead of this (problematic):
  /exe @func(x) = [
    when !@x [ => null ]      # Just a statement, exe continues
    show "continues here"
    => "default"
  ]

  # Use this (correct):
  /exe @func(x) = when first [
    !@x => null               # Early exit path
    * => "default"           # Normal path
  ]

With 'when first' as the exe's direct return value, only one branch executes and becomes the function's return value.

