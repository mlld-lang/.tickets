---
id: m-582e
status: closed
deps: []
created: 2026-02-02T18:28:24Z
type: task
priority: 2
assignee: Adam
tags: [urgency-critical, bug, interpreter]
updated: 2026-02-02T18:55:05Z
---
# BUG: OR (||) in for...when doesn't filter - returns all items

## Summary

The `||` (OR) operator in `for...when` expressions does not filter correctly. Instead of returning only items matching the condition, it returns ALL items.

## Reproduction

```mlld
var @items = ["apple", "banana", "cherry", "date"]

// BROKEN - returns ALL items ["apple", "banana", "cherry", "date"]
var @filtered = for @item in @items when @item.startsWith("b") || @item.startsWith("c") => @item

// WORKS - returns ["banana"]
var @filtered2 = for @item in @items when @item.startsWith("b") => @item

// WORKS - returns ["banana"]  
var @filtered3 = for @item in @items when @item.startsWith("b") && @item.endsWith("a") => @item
```

## Impact

- Single conditions work
- AND (&&) conditions work
- OR (||) conditions DO NOT filter at all

This broke `@parseBulletList` in j2bd which uses `startsWith("- ") || startsWith("* ")`.

## Workaround

Split into separate filters and concat:
```mlld
let @dash = for @line in @lines when @line.startsWith("- ") => @line
let @star = for @line in @lines when @line.startsWith("* ") => @line
=> @dash.concat(@star)
```

## Location

Likely in interpreter for-loop or when-expression evaluation.

