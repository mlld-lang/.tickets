---
id: m-74f6
status: closed
deps: []
created: 2026-02-03T07:15:25Z
type: task
priority: 2
assignee: Adam
tags: [phase-4, adversarial, urgency-high]
updated: 2026-02-03T07:30:00Z
---
# Adversarial verification of sandbox enforcement

Phase 4: Red team testing to PROVE restrictions work with execution evidence.

Required tests (with Docker provider):

1. **Artifact runs end-to-end**: Run `mlld run j2bd/security/impl/sandbox-demo.mld` and capture output

2. **Tool restrictions PROVEN**: Create test that attempts to use a tool NOT in the allowed list inside an env block. Since tool enforcement at mlld level is a known gap (m-3ad1), test using `capabilities.deny` in policy which IS enforced.

3. **Filesystem limits PROVEN**: Create test with Docker provider that attempts write outside allowed paths. Should be blocked by -v mount restrictions.

4. **Network restrictions PROVEN**: Create test with Docker provider using `net: 'none'` that attempts `curl` or similar. Should be blocked by --network none.

5. **Credential protection PROVEN**: Create test that defines a `secret` labeled variable and attempts to `show` it or interpolate it into a command. Should be blocked by label flow rules.

Each test must document:
- Exact mlld code run
- Expected behavior (should be blocked)
- Actual output (proving it was blocked)

Success = All 5 tests show restrictions being ENFORCED, not just declared.


**2026-02-03 07:30 UTC:** Adversarial testing ran 10 tests: 4 PASS (Docker net, Docker fs, capabilities.allow, guards), 4 FAIL (secret show/interpolate without guards, defaults.rules, capabilities.deny), 2 PARTIAL/BLOCKED. Remediation ticket m-09a2 updated documentation. Claims now accurately reflect what is enforced vs spec-only. Known limitations (m-3ad1 tools, m-289d MCP) remain documented as future work.
