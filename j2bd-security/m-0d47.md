---
id: m-0d47
status: closed
deps: []
created: 2026-02-05T18:55:48Z
type: task
priority: 2
assignee: Adam
tags: [phase-2, urgency-high]
updated: 2026-02-05T19:01:42Z
---
# Create working security demo for 4 protections

Phase 2 implementation: Create demonstration code showing all 4 protections from the scenario working.

## Protections to demonstrate

1. **Secret → exfil blocked**: var secret @apiKey cannot flow to exe exfil @fn
2. **MCP data → destructive blocked**: src:mcp tainted data cannot flow to exe destructive @fn
3. **PII → show/log blocked**: var pii @email cannot flow to op:show or op:log
4. **Clear error messages**: When blocked, errors explain why

## Investigation findings

The Target Example in the job uses `policy.operations: { "net:w": exfil }` to classify semantic labels as risk categories. **This is NOT implemented** in label-flow.ts.

The CURRENT working approach uses direct labels:
- `exe exfil @postToServer(data)` - label directly on exe
- Policy rules check for `exfil`, `destructive`, `privileged` directly

## Your task

1. Create a working demo script in `tmp/security-demo.mld` using the CURRENT direct-label approach
2. Verify each of the 4 protections works
3. Document what works and what doesn't
4. If something doesn't work, identify the specific gap

## Expected outcome

Either:
- A working demo proving all 4 protections work with current design, OR
- Specific gaps identified (e.g., "pii label flow rules don't fire because X")

## Relevant code

- core/policy/label-flow.ts - main flow checking logic
- core/policy/builtin-rules.ts - no-secret-exfil etc.
- docs/src/atoms/security/*.md - the documented patterns


**2026-02-05 19:01 UTC:** Completed with workaround approach. Target Example's policy.operations syntax is NOT implemented - worker used direct exe labels instead. This achieves the protections but doesn't match the documented target. Next step: create adversarial ticket to test both the working approach AND identify if policy.operations gap matters for exit criteria.
