---
id: m-310a
status: closed
deps: []
created: 2026-02-09T19:36:54Z
type: task
priority: 2
assignee: Adam Avenir
tags: [doc-polish, excellence]
updated: 2026-02-09T19:42:03Z
---
# Polish sandbox atoms: cross-refs, examples, common mistakes

Address 10 polish gaps identified by excellence assessment. All are documentation edits to existing atoms.

## Changes needed:

### 1. _index.md (PG-1)
Add a sentence mentioning environments: 'Environments provide isolation and credential management for sandboxing agents.'

### 2. env-overview.md (PG-2, PG-4, PG-5, PG-9)
- **Cross-refs**: Update frontmatter `related:` to include env-config, env-blocks, policy-auth, policy-capabilities (keep existing entries too)
- **End-to-end example**: Add a 'Complete sandbox example' section before the closing 'See...' line showing env config + policy + env block combined in one working example (~10 lines of mlld). Use inline >> comments to explain each field.
- **sandbox-demo.mld reference**: Add 'For a complete working example, see `llm/run/j2bd/security/impl/sandbox-demo.mld`' near the bottom
- **Reading order**: Update the closing line to: 'Reading order: `env-config` for configuration fields, `env-blocks` for scoped execution, `policy-capabilities` for restrictions, `policy-auth` for credentials.'

### 3. policy-auth.md (PG-3, PG-8)
- **union() explanation**: After the first `policy @p = union(@policyConfig)` line (line 22), add inline comment: `>> union() activates a policy config — see policy-composition for composing multiple policies`
- **show-secret gap**: Add a note after the 'Label flow checks' section: 'Note: `no-secret-exfil` blocks secrets flowing through `exfil`-labeled operations. To also block direct `show`/`log` of secrets, add label flow rules: `labels: { secret: { deny: ["op:show", "op:log"] } }`'

### 4. policy-capabilities.md (PG-7, PG-10)
- **Flat vs nested**: After the flat syntax example (line 54), add: 'Both forms are equivalent. The nested form (`capabilities: { ... }`) is more explicit; the flat form places `allow`/`deny` at the top level as shorthand.'
- **Common mistakes**: Add a 'Common mistakes' section at the bottom:
  - `tools` only routes MCP tools — use `capabilities.deny` to block commands
  - Keychain access requires both `danger: ["@keychain"]` AND `projectname` in `mlld-config.json`

### 5. env-config.md (PG-6)
- **MCP complexity**: Add 'Advanced:' prefix to the MCP configuration heading: '**Advanced: MCP configuration via `@mcpConfig()`:**'

### 6. env-overview.md inline comments (PG-9)
- Add >> comments to the first config example explaining key fields

## Validation
After all edits, run `mlld validate` on any new or modified code examples to ensure they still pass.

