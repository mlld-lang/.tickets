---
id: m-6232
status: closed
deps: []
created: 2026-02-03T20:53:19Z
type: task
priority: 2
assignee: Adam
tags: [urgency-high, adversarial]
updated: 2026-02-03T21:00:50Z
---
# Adversarial re-verification of all exit criteria

Re-run the full adversarial verification suite after the capabilities.deny sh fix (commit 0daf60e43).

Test each exit criterion:

1. **Artifact runs end-to-end**: Run `mlld run j2bd/security/impl/sandbox-demo.mld` - verify no errors. If `policy @p = union(@policyConfig)` still errors, note it.

2. **Tool restrictions (capabilities.deny sh)**: Run:
```mlld
policy @noShell = {
  capabilities: {
    deny: ["sh"]
  }
}

run sh { echo "This should not execute" }
```
Expect: blocked by __policy_deny_sh guard.

3. **Filesystem limits**: Re-run Docker filesystem test from adversarial-results.md Test 10.

4. **Network restrictions**: Re-run Docker network test from adversarial-results.md Test 9.

5. **Credential protection**: Test both:
- `var secret @key = "abc"` then `show @key` (with a guard protecting it)
- `var secret @key = "abc"` then `run cmd { echo @key }` (with a guard protecting it)

For credential protection: the current implementation requires explicit guards for secret blocking. If defaults.rules enforcement is not implemented, document whether sandbox-demo.mld includes the necessary guard definitions.

Return status: "verified" if all exit criteria pass, or detailed failure report if not.


**2026-02-03 21:00 UTC:** Adversarial re-verification complete. 7/9 claims pass. Two failures: (1) deny sh bypass via run cmd { sh -c ... } without allow list, (2) sandbox-demo.mld credential claims lack guard definitions. Results: j2bd/security/runs/2026-02-03-6/worker-m-6232-3.json
