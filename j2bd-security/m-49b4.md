---
id: m-49b4
status: closed
deps: []
created: 2026-02-04T07:12:57Z
type: task
priority: 2
assignee: Adam
tags: [phase-3, phase-4, adversarial]
updated: 2026-02-04T07:34:32Z
---
# Phase 3+4: Verify and adversarial-test reusable environment module

Verify the reusable environment module implementation works end-to-end and attempt to break it.

Phase 3 verification checklist:
- Run `mlld validate pipeline/env-module/index.mld` - confirm valid module with exports
- Run `mlld validate pipeline/env-module-demo.mld` - confirm valid consumer script
- Verify `profiles { }` syntax works: check test feat/policy/wants-basic passes, and that the module's profiles block parses correctly
- Verify `policy @config = { auth: { } }` syntax works: check tests/cases/docs/cli/04/example.mld pattern
- Verify `using auth:name` syntax works in exe definitions
- Verify import/export workflow: consumer script can import @spawn from the module
- Run `npm run test:case -- feat/policy` to confirm all policy-related tests pass
- Run `npm run test:case -- docs/cli/04` to confirm auth pattern test passes

Phase 4 adversarial checks:
- Try importing a nonexistent export from the module
- Try using the module without /needs being satisfied
- Try accessing credentials directly (should be sealed via policy.auth)
- Verify profile selection: if policy denies 'sh', readonly profile should be selected over full
- Check that all 5 atoms (env-overview, env-config, policy-auth, policy-composition, modules-exporting) exist and have valid mlld examples
- Run mlld validate on every code block in the atoms

Exit criteria items to verify:
1. A user can create a packaged environment module (pipeline/env-module/index.mld demonstrates this)
2. Another user can import and use it (pipeline/env-module-demo.mld demonstrates this)
3. Proper credential handling via policy.auth and using auth: (not hardcoded values)
4. Profile system with full/readonly variants works
5. All 5 documentation atoms exist with working validated examples

