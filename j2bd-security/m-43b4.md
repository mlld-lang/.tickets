---
id: m-43b4
status: closed
deps: []
created: 2026-02-09T10:27:26Z
type: task
priority: 2
assignee: Adam Avenir
tags: [adversarial, phase-4]
updated: 2026-02-09T10:37:31Z
---
# Adversarial: Prove audit ledger taint propagation exit criteria

## Adversarial Verification

Phases 1-3 are complete. This ticket proves the exit criteria hold.

### Exit Criteria to Verify

1. **The audit ledger provides a clear, queryable history** - write events with path/taint/writer fields are recorded and can be queried from mlld scripts
2. **File taint propagation is visible through both labels and audit entries** - reading a file written with labeled data inherits those labels

### Verification Tasks

1. **Run `mlld validate` on `llm/run/j2bd/security/impl/audit-ledger-demo.mld`** to confirm the demo script is syntactically valid
2. **Inspect the runtime code paths** to verify:
   - `logFileWriteEvent()` in `interpreter/utils/audit-log.ts` records path, taint, and writer
   - `getAuditFileDescriptor()` in `core/security/AuditLogIndex.ts` reads write events and builds SecurityDescriptor
   - `content-loader.ts` merges audit descriptors into file reads
3. **Check edge cases**:
   - What happens when the same file is written twice with different labels? Does the latest write's taint win?
   - What happens when audit.jsonl doesn't exist yet (first run)? Does the system handle it gracefully?
   - Is path normalization consistent between write and read (relative vs absolute paths)?
4. **Verify documentation accuracy**:
   - Does the audit-log atom correctly document all 6 event types and their fields?
   - Does the label-tracking atom accurately describe file I/O taint inheritance?
   - Does the labels-sensitivity atom correctly show secret label propagation?
5. **Attempt to falsify claims**:
   - Try to find a code path where a file write does NOT log to audit.jsonl
   - Try to find a code path where a file read does NOT check audit.jsonl for prior taint
   - Check if the demo script's `exe @findWrite` js block would actually work with real audit.jsonl data format

### Report Format

Return exit_criteria_results with each exit criterion as PASS or FAIL with evidence.


**2026-02-09 10:37 UTC:** Adversarial worker verified 2/2 exit criteria PASS, 10/10 additional tests PASS. Three friction points filed: (1) EffectHandler double-write, (2) secondary read paths missing audit taint, (3) logFileWriteEvent path normalization. None are blockers for this job.
