---
id: m-735a
status: closed
deps: []
created: 2026-02-05T14:32:02Z
type: task
priority: 2
assignee: Adam
tags: [adversarial, phase-4, urgency-high]
updated: 2026-02-05T14:41:36Z
---
# Adversarial verification: MCP security features

## Objective

Prove all MCP security exit criteria are met through adversarial testing.

## Exit Criteria to Verify

1. **MCP Import** - `import tools from mcp` syntax works
2. **Auto-tainting** - MCP tool outputs have `src:mcp` in `@result.mx.taint`
3. **Guards trigger** - Guards can intercept MCP tool calls (via `op:exe` since `op:mcp` doesn't exist)
4. **Secret blocking** - Secret-labeled data cannot flow to MCP tools
5. **Audit trail** - After-guards can log/audit MCP tool usage

## Known Gap

The original spec mentioned `guard before op:mcp` syntax. Investigation shows:
- MCP tool calls have operation type `exe`, not `mcp`
- `guard before op:exe` DOES fire on MCP calls
- The atoms correctly document the working syntax

This is a spec vs implementation difference. The IMPLEMENTATION is correct (guards work via op:exe). The original SPEC was aspirational.

## Test Plan

1. Run `pipeline/mcp-security-demo.mld` end-to-end
2. Create adversarial scripts that try to:
   - Bypass secret blocking by relabeling data
   - Access MCP tools without taint propagation
   - Circumvent guards on MCP calls
3. Verify all blocking is categorical (works for pattern, not just test case)

## Success Criteria

Return `status: 'verified'` with `exit_criteria_results` array showing PASS for each criterion.


**2026-02-05 14:41 UTC:** Exit criteria results: MCP Import=PASS, Auto-tainting=PASS, Guards trigger=PASS, Secret blocking=PASS, Audit trail=PASS. Ready for final review (high polish).
