---
id: m-166b
status: closed
deps: []
created: 2026-02-04T12:44:12Z
type: task
priority: 2
assignee: Adam
tags: [doc, security, signing, phase-1]
updated: 2026-02-04T12:48:57Z
---
# Write pattern-audit-guard atom: full multi-agent audit pattern

Write the pattern-audit-guard atom for docs/user/security/pattern-audit-guard.md.

This is a capstone atom showing the full multi-agent audit pattern combining all security concepts: signing, verification, influenced labels, policy, and guards.

Requirements:
- 100-200 words with working mlld code examples
- Show the complete flow: untrusted input → influenced output → audit with signed template → action/rejection
- Reference existing atoms: signing-overview, sign-verify, autosign-autoverify, labels-influenced
- Code examples must pass mlld validate
- Use the same frontmatter format as other atoms in docs/user/security/

The reference implementation is at llm/run/j2bd/security/impl/main.mld - use its patterns but condense for atom format.

Key patterns to demonstrate:
1. Policy config with autosign, autoverify, and untrusted-llms-get-influenced
2. Signed audit template with @content placeholder
3. exe llm functions (one for processing, one for auditing)
4. var untrusted for external data
5. Conditional action based on audit result

Keep examples realistic but concise. Use printf-based mocks for LLM calls (exe llm @fn = run cmd { printf ... }) so examples work without actual LLM access.

