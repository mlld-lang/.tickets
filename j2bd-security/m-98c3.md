---
id: m-98c3
status: closed
deps: []
created: 2026-02-09T10:17:15Z
type: task
priority: 2
assignee: Adam Avenir
tags: [phase-2, urgency-high]
updated: 2026-02-09T10:21:39Z
---
# Audit ledger taint propagation demo

Build an implementation matching the target example that demonstrates:

1. Create a `secret`-labeled variable (`var secret @token = "sk-live-123"`)
2. Write it to disk with `output @token to "audit-ledger-demo.txt"`
3. Read it back with `var @loaded = <audit-ledger-demo.txt>`
4. Show `@loaded.mx.labels` to confirm `["secret"]` persists through file I/O
5. Read the audit log from `@base/.mlld/sec/audit.jsonl`
6. Use a JS exe to find the write event matching the demo file
7. Display the write event to show path, taint, and writer fields

Target file: `llm/run/j2bd/security/impl/audit-ledger-demo.mld`

The target example code is:
```mlld
var secret @token = "sk-live-123"
output @token to "audit-ledger-demo.txt"

var @loaded = <audit-ledger-demo.txt>
show @loaded.mx.labels

var @audit = <@base/.mlld/sec/audit.jsonl>
exe @findWrite(events) = js {
  return events.find(event => event.event === "write" && event.path.endsWith("audit-ledger-demo.txt"));
}
var @writeEvent = @findWrite(@audit)
show `Write event: @writeEvent.event`
```

Validate syntax with `mlld validate` before returning. The script should be self-contained and demonstrate all three exit criteria:
- write events record path, taint, and writer
- read values inherit taint from the latest write
- the audit ledger provides a queryable history


**2026-02-09 10:21 UTC:** Worker confirmed: valid module, exports findWrite exe, needs node runtime. Demo matches target example code from success criteria.
