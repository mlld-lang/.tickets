---
id: m-393a
status: closed
deps: []
created: 2026-02-05T12:49:58Z
type: task
priority: 2
assignee: Adam
tags: [phase-4, adversarial]
updated: 2026-02-05T12:54:21Z
---
# Adversarial verification of builtin-rules

## Objective

Red-team test the built-in rules implementation to PROVE the exit criteria hold.

## Exit Criteria to Verify

1. Built-in rules enforce common protections with labeled operations and minimal configuration
2. no-secret-exfil blocks secret->exfil flow
3. no-untrusted-destructive blocks untrusted->destructive flow
4. Error messages include rule name

## Adversarial Tests Required

### Test 1: Attempt to bypass via label manipulation
- Can untrusted data be relabeled to avoid destructive block?
- Can secret data be relabeled to avoid exfil block?
- Document how mlld handles label removal attempts

### Test 2: Edge cases
- Data with BOTH secret AND untrusted labels - what happens?
- Operation with BOTH exfil AND destructive labels - are all applicable rules checked?
- Empty data or null values - do rules still apply?

### Test 3: Error message quality
- Are rule names fully qualified (policy.defaults.rules.X)?
- Do errors explain what labels caused the block?
- Do errors suggest remediation?

### Test 4: Configuration variations
- What if only some rules enabled in defaults.rules?
- What if defaults.rules is empty array?
- What if defaults.rules is missing entirely?

## Return Format

Return status: "verified" with exit_criteria_results array showing PASS/FAIL for each exit criterion, or status: "failed" with specific failures and reproduction steps.

## Files to Test

- j2bd/security/artifacts/builtin-rules-demo.mld (existing demo)
- Create adversarial test scripts as needed in tmp/

