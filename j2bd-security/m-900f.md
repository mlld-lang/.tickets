---
id: m-900f
status: closed
deps: []
created: 2026-02-09T11:52:17Z
type: task
priority: 2
assignee: Adam Avenir
tags: [phase-4, adversarial]
updated: 2026-02-09T12:35:05Z
---
# Phase 4: Adversarial verification of two-step pattern

Red-team test the built-in rules + two-step pattern implementation. Try to:

1. Bypass no-secret-exfil by transforming secret data (uppercase, slice, template interpolation) before passing to exfil-classified operation
2. Bypass no-untrusted-destructive by copying untrusted data to a new var
3. Test that operations mapping applies transitively - if net:w maps to exfil, does a multi-label exe (net:w, fs:w) get BOTH classifications?
4. Test edge: what happens with empty operations mapping? Do rules still fire for direct risk labels (exe exfil @fn)?
5. Test that denied => handler catches all 4 rule types consistently
6. Test error messages include rule name in all enforcement paths
7. Run the defaults-rules.mld demo end-to-end and verify output matches expectations
8. Verify documentation atoms (labels-sensitivity, labels-trust, policy-operations, policy-label-flow, policies) accurately describe what the implementation does

Artifact: llm/run/j2bd/security/impl/defaults-rules.mld
Code: core/policy/label-flow.ts, core/policy/guards.ts
Docs: docs/src/atoms/security/

Exit criteria to verify:
- Built-in rules enforce common protections using the two-step pattern (semantic labels + policy classification) with minimal configuration
- Phase 1: defaults.rules described with concrete examples, rule names map to pairs, policy.operations explained, two-step pattern documented
- Phase 2: Demo declares defaults.rules, defines semantic labels, configures operations, shows secret→exfil blocked, untrusted→destructive blocked
- Phase 3: no-secret-exfil blocks via classified ops, no-untrusted-destructive blocks, error messages include rule name, two-step pattern clearly explained


**2026-02-09 12:35 UTC:** Re-verification confirmed: when-expression taint bypass FIXED, for-loop taint bypass FIXED, string concat NaN confirmed BY DESIGN (data destroyed, not leaked). Ready for Phase 5 final review.
