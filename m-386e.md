---
id: m-386e
status: open
deps: [m-1e84]
created: 2026-02-20T21:05:53Z
type: bug
priority: 0
assignee: Adam
updated: 2026-02-20T21:06:00Z
---
# Add per-block-type source taint: src:js, src:sh, src:py, src:cmd, src:template

Source taint should reflect the execution medium, not a generic src:exec.

Current behavior:
- cmd blocks: src:exec (wrong label)
- js/sh/py blocks: no source taint at all
- templates: no source taint
- pure mlld exe: src:exec

Correct behavior:
- js { } blocks → src:js
- sh { } blocks → src:sh
- py { } blocks → src:py  
- cmd { } blocks → src:cmd
- template "file.att" → src:template
- pure mlld exe (no code block) → src:exe

Source taint stacks with input labels: pii var through js block → ["pii", "src:js"]

This enables medium-specific policy rules (e.g. src:sh can't reach net:w).

File loading already works correctly: src:file + dir: hierarchy.

