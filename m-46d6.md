---
id: m-46d6
status: open
deps: []
links: [m-6602, m-29d1, m-fcc5]
created: 2026-02-09T06:19:47Z
type: feature
priority: 2
assignee: Adam Avenir
tags: [security, needs-human-design, core]
---
# Design: Guard execution timeouts

## Task

Design guard execution timeouts to harden the enforcement layer itself. This is a DESIGN task — produce a spec section, not an implementation.

## Layer

Core engine.

## Problem

Guards are mlld's enforcement layer — the one layer that must always be available and responsive. If a guard can be DoS'd, the security layer becomes the vulnerability. Two concrete risks:

1. **ReDoS** — A guard using `@input.match(pattern)` where the regex has catastrophic backtracking. If the input comes from an LLM or MCP source, an attacker can craft input that hangs the guard.
2. **Slow external calls** — A guard that calls an external validation service. If the service is slow or unresponsive, the guard blocks the entire pipeline.

Real-world evidence: haystack and AutoGPT explicitly refactored regexes to eliminate catastrophic backtracking. The concern is amplified in LLM frameworks that process unbounded user/model text.

## Design Questions

1. **Default timeout** — What's a sensible default? Guards should be fast (they run on every operation). 1s? 5s? Configurable per-guard or globally?
2. **Policy syntax** — Strawman:
   ```mlld
   policy {
     guards: {
       timeout: 5000  // ms, applies to all guards
     }
   }
   ```
   Per-guard override?
   ```mlld
   guard @slowValidator before op:db [timeout: 10000] = ...
   ```
3. **Failure mode** — Guard exceeds timeout: deny (fail-closed) or allow (fail-open)? Fail-closed is safer but could block legitimate operations. Should this be configurable?
4. **ReDoS static analysis** — Should mlld validate regex patterns in guards at parse time for known catastrophic patterns? Or is a timeout sufficient? Static analysis is hard to get right but timeouts are reactive.
5. **Audit logging** — Should timeout events be logged to the audit ledger? (Yes — they indicate either a bug or an attack.)
6. **Interaction with privileged guards** — Privileged guards that bless data are security-critical. Should they have stricter or more lenient timeouts?
7. **Nested guards** — If a guard triggers another guard, how does the timeout budget work? Per-guard or shared?

## Deliverable

A spec section covering timeout semantics, configuration syntax, failure modes, and audit integration.

