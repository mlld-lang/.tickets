---
id: m-19a7
status: closed
deps: [m-8e81]
created: 2026-02-25T06:21:41Z
type: bug
priority: 0
assignee: Adam Avenir
updated: 2026-02-25T17:42:14Z
---
# Sanitize FieldAccess error output for namespace objects

## Bug

When you access an unexported field on a namespace import, the error message dumps hundreds of lines of internal runtime state (AST nodes, capturedModuleEnv with private variable values, metadata objects). The error is unreadable and leaks private module internals.

## Reproduction

Create module.mld that exports @foo but not @bar:
```mlld
var @foo = "public"
var @bar = "private"
export { @foo }
```

Create main.mld:
```mlld
import "module.mld" as @ns
var @x = @ns.bar
```

Run `mlld main.mld`. The error output is hundreds of lines of internal AST and capturedModuleEnv.

## Acceptance criteria

The error message for accessing an unexported namespace field must contain ONLY:
1. The field name that was accessed (e.g., "bar")
2. The namespace variable name (e.g., "@ns")
3. A list of the available exported field names from that namespace (e.g., "foo")
4. The source file location of the import

The error message must NOT contain:
- The string "capturedModuleEnv"
- AST node objects or arrays
- Internal metadata objects
- More than ~10 lines of output

## Where to look

The FieldAccess evaluator or property resolution code that handles namespace objects. When field resolution fails on a namespace, it currently serializes the entire namespace object into the error. Change it to format only the exported key names.

## Dependency

Depends on m-8e81 (sealing capturedModuleEnv). Even after this error is fixed, m-8e81 ensures capturedModuleEnv can't leak through OTHER paths. This ticket fixes the error formatting specifically; m-8e81 fixes the root exposure.
