---
id: m-a310
status: open
deps: [m-d94b]
created: 2026-02-10T19:51:43Z
type: task
priority: P1
assignee: Adam
tags: [structured-value, data-model, field-access]
updated: 2026-02-12T21:30:00Z
---
# Deprecate and remove top-level system properties — use .mx.* exclusively

System properties on StructuredValues are currently exposed at the top field level (.text, .data, .type, .length, .filename, .url, etc.), colliding with common user data field names. These properties already have .mx.* equivalents for most cases. Deprecate the top-level versions, add .mx.* equivalents for the gaps, then remove the top-level accessors.

Rationale:
- .text, .data, .type, .length, .json, .source are extremely common user data field names
- .mx is already the system namespace on values — most of these already exist under .mx
- Top-level system properties make user field access unpredictable: "is .type my data's type field or the StructuredValue type?"
- After this change, all system properties live under .mx, all top-level dotted access goes to user data

## Audit: what moves

### High collision risk (common user field names)
| Top-level | .mx equivalent | Status |
|-----------|---------------|--------|
| .text | .mx.text | m-d94b adds it |
| .data | .mx.data | m-d94b adds it |
| .type | .mx.type | already exists |
| .length | .mx.length | already exists |
| .json | .mx.json | already exists |
| .source | .mx.source | already exists |
| .metadata | n/a | just remove (legacy/internal) |
| .content | n/a | just remove (.mx.text covers it) |

### Medium collision risk (loaded content / URL / shell metadata)
All already have .mx equivalents:
- .filename, .path, .relative, .absolute → .mx.filename, .mx.path, .mx.relative, .mx.absolute
- .title, .description, .url, .domain → .mx.title, .mx.description, .mx.url, .mx.domain
- .status, .headers, .html → .mx.status, .mx.headers, .mx.html
- .command, .exitCode, .duration, .stderr → .mx.command, .mx.exitCode, .mx.duration, .mx.stderr
- .tokens, .tokest, .fm → .mx.tokens, .mx.tokest, .mx.fm

### Not moving (already safe)
- .mx itself (already the namespace)
- .keys, .values, .entries (already under .mx)
- Method-style accessors: .includes(), .startsWith(), .endsWith(), .join(), etc.
- .keep, .keepStructured (internal flags, not data field collisions)
- .any, .all, .none (guard quantifiers — already data-first precedence)
- .raw, .isComplex, .totalTokens, .maxTokens (Variable-level metadata, not StructuredValue)
- .internal (implementation detail, not user-facing)

## Implementation

### Gaps to fill
1. Add .mx.text and .mx.data (handled by m-d94b, prerequisite)
2. .metadata — just remove top-level access, don't add .mx.metadata (it's legacy/internal)
3. .content — just remove top-level access, don't add .mx.content (.mx.text serves the same purpose)

### Deprecate and remove in field-access.ts
- interpreter/utils/field-access.ts: remove top-level handling for all system properties listed above
- IMPORTANT: also remove the generic .mx fallback at field-access.ts:443 that forwards unknown field access to .mx — this back door would re-expose all the properties we're removing
- After m-d94b lands (auto-resolution through .mx.data), top-level field access on user data works naturally
- System properties only accessible via .mx.*

### Update tests and fixtures
- Fix all tests that use top-level system property access
- Update fixture expected outputs
- Add deprecation/removal test coverage

### Update docs
- docs/dev/DATA.md: update field access documentation
- docs/user/reference.md, docs/user/content-and-data.md
- docs/llm/llms-syntax.txt
- All atoms referencing top-level system properties

Acceptance criteria:
- All system properties accessible only via .mx.*
- Top-level dotted access on StructuredValues goes to user data exclusively
- No top-level system property collisions with user field names
- Tests and docs updated
- Full test suite passes
