---
id: m-6c88
status: open
deps: []
created: 2026-02-02T22:12:17Z
type: task
priority: 2
assignee: Adam
---
# When expression errors need file/line context

## Issue

When a when expression fails, the error message doesn't indicate which file or line the expression is on.

## Current Error

```
MlldWhenExpression: When expression evaluation failed with 1 condition errors

Details:
  errors: [undefined] Error evaluating condition 3: Directive error (when): Failed to evaluate condition value
```

## Problems

1. No file path shown
2. No line number shown
3. "condition 3" doesn't tell me what the condition WAS
4. "Failed to evaluate condition value" doesn't say what value or why

## Expected

```
MlldWhenExpression: When expression evaluation failed with 1 condition errors

  at lib/context.mld:14 in @loadRecentEvents
  
  Condition 3 (* => @line | @json) failed:
    Error: JSON parsing failed - invalid character 'x' at position 0
    Input was: "not valid json"
```

## Impact

Debugging when expressions is very difficult - you have to binary search through code to find which when is failing.

