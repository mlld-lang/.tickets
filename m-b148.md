---
id: m-b148
status: closed
deps: []
created: 2026-02-20T01:19:10Z
type: bug
priority: 0
assignee: Adam Avenir
tags: [bug, grammar, guards]
updated: 2026-02-24T17:24:54Z
---
# guard action trusted\! syntax rejected by parser

In a privileged guard, `=> trusted\! @output` is rejected by the parser — it expects allow/deny/retry/env after `=>`. The `trusted\!` label modification syntax works in return statements (`=> trusted\! @var`) but not in guard when-block actions. Privileged guards should support label modification actions like `trusted\!`, `\!label`, and `clear\!` since that's the primary reason to mark a guard as privileged.


**2026-02-24 17:24 UTC:** Verified fixed in current branch (~/dev/mlld). The parser correctly handles trusted\! in guard actions — AST shows addLabels: [trusted], removeLabels: [untrusted]. The mlld.2 copy has the older parser that doesn't support this yet.
