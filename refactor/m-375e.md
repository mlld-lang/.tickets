---
id: m-375e
status: open
deps: [m-b564]
links: []
created: 2026-02-09T06:03:26Z
type: task
priority: 1
assignee: Adam Avenir
parent: m-9f2b
tags: [refactor, exec-invocation, phase-7, command]
---
# Phase 7: Extract command executable handler

Objective:
Extract command executable flow (highest risk path) into a dedicated handler.

Instructions for the implementing agent:
- Move command execution logic into `interpreter/eval/exec/handlers/command.ts` (or equivalent), including:
  - autoverify/signature checks
  - command template interpolation
  - env/auth/using injection
  - provider execution path
  - oversized-env bash fallback
  - command-level with-clause pipeline handling
- Preserve shell validation, security descriptor propagation, and policy label-flow checks.
- Verify command output normalization and stdin handling remain identical.

## Acceptance Criteria

1. Command executable path is isolated in a dedicated handler module.
2. Autoverify, env injection, provider, and fallback behavior remain consistent.
3. Command-focused tests (including autoverify/env-injection/security regressions) remain green.
4. Full test gate passes and output is attached:
   npm run build && npm test && npm run test:tokens && npm run test:examples

