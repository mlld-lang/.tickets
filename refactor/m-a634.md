---
id: m-a634
status: open
deps: [m-375e]
links: []
created: 2026-02-09T06:03:26Z
type: task
priority: 1
assignee: Adam Avenir
parent: m-9f2b
tags: [refactor, exec-invocation, phase-8, code]
---
# Phase 8: Extract code executable handler

Objective:
Extract code executable flow into dedicated handler(s).

Instructions for the implementing agent:
- Move code-language dispatch into `interpreter/eval/exec/handlers/code.ts` (or equivalent), including:
  - mlld-when / mlld-foreach / mlld-for / mlld-loop / mlld-exe-block flows
  - bash/sh code-path behavior
  - js/node/python parameter shaping and shadow environment capture
  - auto-unwrap restoration and structured result normalization
- Preserve metadata/security propagation and with-clause processing.

## Acceptance Criteria

1. Code executable path is isolated in dedicated handler module(s).
2. Language-specific behavior remains unchanged.
3. Code execution, shadow env, and structured output tests remain green.
4. Full test gate passes and output is attached:
   npm run build && npm test && npm run test:tokens && npm run test:examples

