---
id: m-96c2
status: open
deps: [m-c2bb]
links: []
created: 2026-02-09T06:03:26Z
type: task
priority: 1
assignee: Adam Avenir
parent: m-9f2b
tags: [refactor, exec-invocation, phase-1]
---
# Phase 1: Extract pure helper utilities from exec-invocation

Objective:
Extract pure helper utilities from `interpreter/eval/exec-invocation.ts` without changing control flow.

Instructions for the implementing agent:
- Move stateless helpers into dedicated modules (suggested: `interpreter/eval/exec/context.ts` and neighboring files):
  - operation type resolution
  - security descriptor carrier/merge helpers
  - auth/using with-clause merge helper
  - shadow env deserialization helper
  - other pure formatting/normalization helpers
- Keep function signatures and call behavior stable.
- Do not alter execution ordering or side effects.
- Keep `evaluateExecInvocation` exported from `exec-invocation.ts`.

## Acceptance Criteria

1. Pure helpers are extracted and imported from focused modules.
2. `evaluateExecInvocation` public entrypoint remains stable.
3. No behavioral drift is observed in characterization tests.
4. Full test gate passes and output is attached:
   npm run build && npm test && npm run test:tokens && npm run test:examples

