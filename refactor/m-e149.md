---
id: m-e149
status: open
deps: [m-493d]
created: 2026-02-09T07:01:17Z
type: task
priority: 1
assignee: Adam Avenir
parent: m-225c
tags: [refactor, content-loader, phase-2]
updated: 2026-02-09T07:01:17Z
---
# Refactor Program: Modularize interpreter/eval/content-loader.ts - Phase 2: Extract AST extraction pipelines



Objective:
Isolate AST extraction flow from general content loading.

Instructions for the implementing agent:
- In scope: AST extraction pipelines for name-list/content pattern variants.
- Out of scope: source reconstruction and URL/file/glob transport handlers.
- Extract name-list/content AST flow (pattern variable resolution, pattern validation, file/glob extraction) into dedicated AST loader modules.
- Preserve returned shapes for AST results and name-list metadata in glob mode.
- Add tests for pattern validation errors and mixed file/glob AST extraction behavior.

Module boundaries:
- AST pipeline module owns pattern resolution/validation and AST extraction routing.
- Transport-specific loaders provide content inputs through stable interfaces.
- Finalization logic remains outside AST module boundaries.

Preserve behavior checks:
- Name-list and content-pattern AST extraction semantics remain unchanged.
- Pattern validation error semantics remain unchanged.
- Mixed file/glob AST extraction behavior and metadata shapes remain unchanged.

## Acceptance Criteria

1. AST extraction flow is extracted into dedicated modules for supported variants.
2. AST result shapes and validation behavior remain baseline-compatible.
3. Tests cover variant parity and error paths.
4. Exit criteria: test gate command succeeds and output is attached:
   npm run build && npm test && npm run test:tokens && npm run test:examples
