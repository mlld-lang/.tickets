---
id: m-3469
status: open
deps: []
created: 2026-02-09T06:59:36Z
type: task
priority: 1
assignee: Adam Avenir
parent: m-943f
tags: [refactor, import-directive-evaluator, phase-0]
updated: 2026-02-09T06:59:36Z
---
# Refactor Program: Modularize interpreter/eval/import/ImportDirectiveEvaluator.ts - Phase 0: Baseline and characterization



Objective:
Establish a behavior baseline for all import flows before extraction.

Instructions for the implementing agent:
- In scope: characterization coverage and extraction-boundary mapping only.
- Out of scope: moving runtime logic into new modules.
- Map responsibilities across MCP imports, resolver/input imports, module/node imports, file/url/directory imports, and policy/needs enforcement.
- Add characterization coverage for high-risk branches: alias collisions, import type mismatch validation, directory import skip patterns, module candidate fallback, and policy needs failures.
- Capture extraction seams and regression risks in ticket notes; do not move code across files in this phase.

Preserve behavior checks:
- Import type inference and declared-type mismatch errors remain baseline-locked.
- MCP import alias/binding behavior remains baseline-locked.
- Resolver/module/node/file/url/directory flow parity remains baseline-locked.
- Needs/policy enforcement and binding collision guarantees remain baseline-locked.

## Acceptance Criteria

1. Characterization coverage exists for every listed high-risk branch and preserve-behavior check.
2. Baseline notes include concrete extraction boundaries and regression hazards.
3. No intentional runtime semantic change is introduced.
4. Exit criteria: test gate command succeeds and output is attached:
   npm run build && npm test && npm run test:tokens && npm run test:examples
