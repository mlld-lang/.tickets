---
id: m-8731
status: open
deps: [m-499a]
links: []
created: 2026-02-09T06:19:05Z
type: task
priority: 1
assignee: Adam Avenir
parent: m-ef4e
tags: [refactor, environment, phase-3, variables, resolvers]
---
# Refactor Program: Modularize interpreter/env/Environment.ts - Phase 3: Extract variable and resolver facade

Objective:
Separate variable-facing orchestration from resolver-facing orchestration, keeping `Environment` as a facade.

Instructions for the implementing agent:
- Extract resolver variable flow from `getResolverVariable` into dedicated helper/module(s):
  - reserved-name checks
  - resolver invocation and content conversion
  - security descriptor projection to variable metadata
  - resolver cache read/write behavior
- Group variable-oriented convenience behavior (`setVariable`, `getVariable`, frontmatter aliases, transform lookup, import binding registry) behind cohesive internal methods/modules.
- Preserve interaction boundaries with `VariableManager` and `CacheManager`.

## Acceptance Criteria

1. Resolver and variable orchestration logic is decomposed into focused modules with clear boundaries.
2. Reserved variable semantics and resolver cache behavior remain unchanged.
3. Characterization tests for variable lookup/resolution and frontmatter behavior remain green.
4. Exit criteria: full test gate passes with output attached:
   npm run build && npm test && npm run test:tokens && npm run test:examples

