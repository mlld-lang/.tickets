---
id: m-204b
status: closed
deps: []
created: 2026-02-19T23:02:01Z
type: task
priority: 1
assignee: Adam Avenir
tags: [severity-high, pre-ga]
updated: 2026-02-20T00:00:36Z
---
# Document hook body context variables in reference docs

## Problem

`docs/user/reference.md:532-552` shows hook declaration syntax but provides zero information about variables available inside hook bodies. Without these, users cannot write meaningful hooks.

## Missing documentation

Variables bound in `user-hook-runner.ts:256-265`:
- `@input` — operation inputs (array of args for function hooks)
- `@output` — operation result (after hooks only)
- `@mx.op.name` — function/operation name
- `@mx.op.labels` — labels on the function/invocation
- `@mx.op.type` — operation type (e.g., "exe")
- `@mx.for.index` / `@mx.for.total` / `@mx.for.key` / `@mx.for.parallel` — loop iteration context
- `@mx.for.batchIndex` / `@mx.for.batchSize` — batch context
- `@mx.hooks.errors` — array of errors from hooks that threw
- `@mx.checkpoint.hit` — boolean: was this a cache hit?

## Fix

Add a context variables table to the hooks section of reference.md, matching the spec's Appendix A table.

