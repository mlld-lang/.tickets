---
id: m-576a
status: closed
deps: []
created: 2026-02-09T08:41:30Z
type: bug
priority: 2
assignee: Adam Avenir
updated: 2026-02-09T22:56:26Z
---
# Pipeline label propagation: influenced label not applied

tests/cases/exceptions/security/influenced-label-flow-deny-pipeline: untrusted-llms-get-influenced policy rule doesn't apply 'influenced' label when untrusted data flows through LLM exe in pipeline.


**2026-02-09 22:56 UTC:** Fixed pipeline descriptor overwrite in processPipeline. Final structured pipeline outputs now merge stage-produced security descriptor with the original pipeline descriptor instead of replacing it, preserving labels added by policy rules (including influenced). Removed skip for tests/cases/exceptions/security/influenced-label-flow-deny-pipeline/skip.md and regenerated fixtures. Verified with: npx vitest run interpreter/interpreter.fixture.test.ts -t "influenced-label-flow-deny(-pipeline)?" and npx vitest run core/policy/builtin-rules.test.ts core/policy/label-flow.test.ts.

**2026-02-09 23:42 UTC:** Follow-up fix for regression from initial patch: preserved structured pipeline argument semantics by cloning structured pipeline output metadata (wrapStructured) and merging only output labels into pipeline descriptor, instead of mutating output descriptor/provenance in place. This keeps influenced-label propagation while preventing structured args from being materialized as JSON strings and avoids extra src:exec taint in pipeline-taint fixture. Verified with: interpreter/interpreter.fixture.test.ts -t integration/issue-435-(full-user-scenario|zipas-pipeline)|security/pipeline-taint|exceptions/security/influenced-label-flow-deny-pipeline and tests/pipeline/exec-structured.test.ts -t keeps structured arguments native...
