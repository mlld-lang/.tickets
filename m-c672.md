---
id: m-c672
status: closed
deps: [m-335e]
created: 2026-02-18T01:28:00Z
type: task
priority: 0
assignee: Adam Avenir
updated: 2026-02-18T06:52:17Z
tags: [docs, guards]
---
# Update defense-in-depth-article.md guard examples for consistency

The defense-in-depth article (defense-in-depth-article.md) has guard examples that should be updated for consistency with the unified label model.

**Lines 179-183:** guard @noSecretExfil before secret checking @mx.op.labels.includes('net:w') â€” the code works but the article should note both approaches:
  1. Guard on the data label, check the operation: guard before secret => check @mx.op.labels
  2. Guard on the operation label, check the data: guard before exfil => check @input.any.mx.labels.includes('secret')

Both approaches are valid. The article should present this as a design choice rather than showing only one path.

**Acceptance criteria:**
- Article shows both approaches for the guard use case
- Consistent with new doc framing (no 'label-entry guard' language)
- Article remains coherent as a standalone security overview

