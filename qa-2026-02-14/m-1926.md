---
id: m-1926
status: closed
deps: []
created: 2026-02-15T08:09:55Z
type: bug
priority: 0
assignee: Adam
tags: [qa-2026-02-14, p0, guards]
updated: 2026-02-15T08:55:13Z
---
# Before guards on op:exe leak internal variable structure

Before guards targeting op:exe output serialized JS objects (type:computed, name:guard_before2_output) instead of resolved values. Combining before LABEL + before op:TYPE also leaks internals into command values.

Workaround: use data label guards instead of operation label guards for before-timing transforms.

QA topics: security-before-guards, security-guard-composition

## Acceptance Criteria

Before guards on op:exe resolve variable values, no internal structure in output


**2026-02-15 08:42 UTC:** StructuredValue issue - see docs/dev/DATA.md. Before guards on op:exe are exposing internal StructuredValue representation instead of using asData()/asText() at the boundary.

**2026-02-15 08:55 UTC:** Implemented guard transform unwrapping for nested Variable replacements to prevent internal Variable serialization in before op:exe guard composition. Added regressions in guard-pre-hook and guard-block-action-evaluator tests; full npm test run passes.
