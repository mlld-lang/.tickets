---
id: m-e722
status: closed
deps: []
created: 2026-02-15T08:09:48Z
type: bug
priority: 0
assignee: Adam
tags: [qa-2026-02-14, p0, cmd-executor]
updated: 2026-02-15T09:09:58Z
---
# cmd executor var-assignment bypass: cwd, policy, and guard enforcement all skipped

The cmd: executor's var-assignment code path diverges from bare-execution, causing three related failures:
1. var @x = run cmd:/path {command} ignores cwd override (sh/js work fine)
2. var @out = run cmd { echo "@mcpData" } bypasses MCP policy enforcement
3. Guards don't fire on standalone @handler(@key); only fire with var @r = @handler(@key)

Likely a single root cause in the cmd executor's var-assignment path.

QA topics: run-cwd, mcp-policy, security-denied-handlers

## Acceptance Criteria

All three behaviors work identically whether or not result is assigned to a variable


**2026-02-15 09:09 UTC:** Routed command-node var assignments through evaluateRun so cwd/policy/guards match run semantics; applied op:exe labeling parity for run exec operations; added regression coverage for policy denial, cwd honoring, and guard parity in variable assignment. Verified with full npm test (4142 passed, 60 skipped).
