---
id: m-2228
status: closed
deps: []
created: 2026-02-16T10:02:12Z
type: bug
priority: 2
assignee: Adam
tags: [bug, interpreter, structured-value]
updated: 2026-02-16T10:13:57Z
---
# bug: .trim() inconsistent on StructuredValues — works on objects, throws on arrays

File loading returns StructuredValues. String methods like .trim() behave inconsistently:
- text file load: .trim() works (expected)
- .json file load (object): .trim() silently stringifies then trims — returns text type
- .jsonl file load (array): .trim() throws 'Cannot call .trim() on object'

Both object and array are non-string StructuredValue types. Either both should support .trim() (by falling back to .text) or both should fail with a clear error. Current behavior is a trap.

Repro:
  var @j = <@base/package.json>       >> object — .trim() works
  var @a = <@base/manifest.jsonl>     >> array — .trim() throws

Discovered during doc-writer orchestrator development.


**2026-02-16 10:13 UTC:** Fixed StructuredValue builtin target normalization to use string view for structured arrays on string-view methods (including .trim), added regression fixture feat/alligator/jsonl-trim-structured-array, and updated CHANGELOG rc82. Validation: npm run test:case -- feat/alligator/jsonl-trim-structured-array; npm test. Commit: 76e0139c9.
