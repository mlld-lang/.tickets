---
id: m-7178
status: closed
deps: [m-0b80, m-3c23]
created: 2026-02-05T03:10:06Z
type: bug
priority: 1
assignee: Adam
updated: 2026-02-05T06:37:51Z
---
# Influenced label tracking works but has zero enforcement

**Problem**: The `shouldAddInfluencedLabel()` function adds the 'influenced' label to LLM outputs when `defaults.rules: ["untrusted-llms-get-influenced"]` is enabled, but there's no enforcement code.

**What exists**:
- Label gets added to metadata ✓ (PolicyEnforcer.applyOutputPolicyLabels)
- Label propagates through transformations ✓

**What's missing**:
- No case in `checkBuiltinPolicyRules()` for `untrusted-llms-get-influenced`
- The rule is parsed but never enforces anything
- Users must manually add `labels: { influenced: { deny: [...] } }` to policy

**Evidence**:
- Adversarial test 5: `defaults.rules: ["no-secret-exfil"]` doesn't block secret display
- interpreter/policy/label-flow.ts has cases for other rules but not this one

**Expected behavior**:
When `untrusted-llms-get-influenced` is enabled, influenced data should be blocked from certain operations (exfil, show, etc.) by default.

**Files**: `core/policy/builtin-rules.ts`, `interpreter/policy/label-flow.ts`

## Plan

**Decision**: Keep `untrusted-llms-get-influenced` as auto-label only (no built-in enforcement).

**Rationale**: Rule name says "get influenced" (provenance tracking), not "influenced is blocked" (enforcement). Users control enforcement via their own policy.

**Implementation:**

- Keep existing auto-labeling behavior in `PolicyEnforcer.applyOutputPolicyLabels`
- Ensure it runs for all `llm`-labeled execution paths (direct exec, pipelines, templates)
- Add tests for:
  - Auto-labeling when rule enabled
  - Label propagation through transformations
  - User-defined `labels.influenced` deny rules working correctly
- Update docs to clarify:
  - Rule enables auto-labeling only
  - Users define enforcement: `labels: { influenced: { deny: ["exfil", "destructive"] } }`
  - Standard policy modules (future work) will provide sane defaults
- No dependency on standard modules - users define their own influenced enforcement rules for now
