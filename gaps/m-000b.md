---
id: m-000b
status: closed
deps: [m-eeca, m-fc30, m-a3f7, m-6cd6]
created: 2026-02-05T03:10:06Z
type: task
priority: 2
assignee: Adam
updated: 2026-02-05T08:41:54Z
---
# Verify secret labels protected when defaults.rules works

**Parent ticket**: m-eeca (defaults.rules guard generation)

**Purpose**: This is a verification task to confirm that when defaults.rules is implemented, secret labels get automatic protection as a key use case.

**What to verify**:
After m-eeca is complete, test that:
1. `defaults.rules: ["no-secret-exfil"]` generates guards for secret labels
2. `var secret @key = "sk-..."; show @key` is BLOCKED
3. `run cmd { echo "@key" }` is BLOCKED from interpolating secrets
4. Error messages are clear about why the operation was denied

**Current state** (before m-eeca):
- Label is parsed and stored ✓
- Label propagates through transformations ✓
- Explicit guards CAN check secret label ✓
- **But no default protection** - secrets freely shown/interpolated

**Test cases to run**:
- Adversarial test 2: `var secret @key; show @key` should be blocked
- Adversarial test 3: `echo "@key"` should be blocked
- Adversarial test 5: `defaults.rules: ["no-secret-exfil"]` should activate protection

**Success criteria**: All three tests above fail with clear policy denial errors.

**Files**: Tests in `llm/run/j2bd/security/impl/adversarial-results.md` to re-run

