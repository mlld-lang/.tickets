---
id: m-904b
status: closed
deps: []
created: 2026-02-12T01:31:26Z
type: feature
priority: 1
assignee: Adam
updated: 2026-02-12T02:38:32Z
---
# Add live state:update for in-flight @state signaling

Support external in-flight state mutation for live SDK executions so long-running scripts can react to control flags without cancellation.

## Design

Add a new NDJSON live RPC method state:update. Method targets an active request id and updates @state in the running environment. Extend live server active execution tracking to expose state update hook alongside abort. Add Environment API for external state updates that refreshes @state variable and dynamic resolver while preserving existing state:// write behavior. Add SDK wrapper APIs (Go/Python/Rust) to send state:update against active runs. Keep process/execute/analyze top-level APIs backward compatible.

## Acceptance Criteria

1) live --stdio accepts state:update with target active request id and returns success/error payloads for missing/finished requests. 2) During an active run, external state:update mutates @state such that subsequent script reads observe updated values. 3) Existing /output to state:// behavior and state:write events remain unchanged. 4) Integration test covers principal use case: script with loop until @state.exit performing long-running LLM-like steps; external state:update sets exit=true; run exits cleanly without cancel. 5) Go, Python, and Rust SDK docs and tests cover in-flight state signaling and loop termination example.

