---
id: m-3392
status: closed
deps: []
links: []
created: 2026-01-29T01:05:24Z
type: bug
priority: 0
parent: 
assignee: Adam
tags: [interpreter, security, labels, templates, impl-blocked]
updated: 2026-01-31T07:07:55Z
---
# Implement label persistence through template interpolation

Labels should persist through template interpolation. If @secret has label:sensitive, then 'prefix @secret suffix' should inherit that label. Guards should check the final interpolated value. Human answer from QA strategy question 2.


**2026-01-30 15:17 UTC:** Enrich reviewed: 2026-01-30T15:14:56.295Z

**2026-01-31 07:08 UTC:** Implemented label persistence through template interpolation:

1. Added extractDescriptorsFromTemplateAst() function in var.ts that walks template AST nodes and extracts security descriptors from variable references

2. For triple-colon templates (lazy evaluation), the function extracts labels from referenced variables at variable creation time, before interpolation happens

3. This ensures guards see the correct labels when checking template variables that contain labeled values

4. Added test cases in tests/cases/security/template-label-persistence/ to verify label extraction and guard integration

5. Also fixed a bug in scripts/build-fixtures.mjs where .mld files weren't being detected in processTestCategory()
