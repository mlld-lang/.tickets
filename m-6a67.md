---
id: m-6a67
status: open
deps: []
created: 2026-02-04T00:47:07Z
type: bug
priority: 2
assignee: Adam
tags: [security]
updated: 2026-02-04T00:47:09Z
---
# capabilities.deny for specific cmd patterns not enforced at runtime

evaluateCommandAccess() correctly handles cmd deny patterns in unit tests, but at runtime deny:['cmd:git:push'] does not block git push. The unit tests in guards-command-access.test.ts pass for deny patterns in isolation, but the full runtime pipeline doesn't enforce cmd deny patterns. Only sh-specific deny works due to special-cased isShellInvocation check. Pre-existing issue found during sandbox-agent security job final review.

