---
id: m-c853
status: closed
deps: []
links: []
created: 2026-02-06T21:50:35Z
type: chore
priority: 2
assignee: Adam Avenir
tags: [when, if, errors, dx]
updated: 2026-02-12T12:04:51Z
---
# Add usage-driven if/when cheat sheet to all conditional error messages

## Context

The current if/when error messages include a cheat sheet but it's organized around syntax forms, not use cases. Replace with a usage-driven cheat sheet that answers "which tool do I reach for?"

## Cheat sheet content

```
Need else?              → if @cond [a] else [b]
Need pattern match?     → when @val ["a" => x; * => y]
Need first-match list?  → when [cond1 => x; cond2 => y]
Simple condition?       → when @cond => action
Multi-statement block?  → when @cond => [action; action]
Guard return in exe?    → when !@x => [=> "error"]
Assign from condition?  → var @x = when [cond => val; * => default]
Several independent?    → just use multiple when lines (each fires independently)
```

The last line is critical — it preempts the #1 LLM mistake of thinking you need `if` for independent conditions, and implicitly teaches that first-match only applies to the list form.

## Where to apply

1. Grammar error messages in when.peggy (WhenSimpleBlockForm, missing arrow, generic catch-all)
2. Grammar error messages in exe-rhs.peggy (WhenExpressionInlineBlock)
3. Compiled error patterns in errors/parse/ (action-in-exe-when, exe-block-when-confusion, when-comma-separated, when-slash-rhs)
4. Any if-related parse errors in if.peggy

Replace the current "if vs when:" blocks with this usage-driven version.

## Also update

- docs/src/atoms — consider a when-vs-if.md atom with this content
- docs/user/flow-control.md — add this as a quick reference table
- llm docs rebuild after atom changes

