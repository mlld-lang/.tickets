---
id: m-c477
status: open
deps: [m-bd0e]
created: 2026-02-22T17:20:17Z
type: bug
priority: 0
assignee: Adam Avenir
tags: [error-handling, grammar]
updated: 2026-02-22T17:31:51Z
---
# Error messages suggest invalid sh(@myVar) syntax in exe context

## Current behavior

When a `cmd {}` block uses forbidden shell operators (>, |, &&, etc.), error messages in `grammar/patterns/unified-run-content.peggy` and `interpreter/env/CommandUtils.ts` suggest this workaround:

```
sh(@myVar) { cmd "$myVar" > out.txt }
```

This is bare `sh(@var)` without `run` â€” it doesn't parse in most contexts.

## Fix

Update the error messages to suggest context-appropriate alternatives:
- In exe context: `exe @fn(path) = sh { echo "$path" > out.txt }` (exe params automatically become shell variables as `$paramName`)
- In run context: `run sh(@path) { echo "$path" > out.txt }`

The error should detect which context it's in and suggest the right pattern. At minimum, stop suggesting bare `sh(@var) { }` which is not valid standalone syntax.

Note: m-bd0e is adding sh(@var) support to exe context, which will also affect what these messages should suggest.

