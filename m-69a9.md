---
id: m-69a9
status: open
deps: []
links: []
created: 2026-01-25T18:31:28Z
type: bug
priority: 1
assignee: Adam Avenir
tags: [grammar, templates, parser, size-s, complexity-m, risk-m]
---
# Templates should not allow arbitrary directives

Templates (triple-colon `:::`, double-colon `::`, backtick) currently allow arbitrary directives like `/show`, `/run`, etc. inside them. This is wrong.

## Current (broken) behavior

```mlld
var @t = :::/show {echo "OK"}:::
/show @t  >> This somehow works
```

## Expected behavior

Templates should ONLY support:
- `@var` - variable interpolation
- `@exe(@arg)` - function/executable calls
- `@exe(@arg)|@pipe` - piped function calls
- `<file.md>` - file loading
- `<path/glob/*.md>` - glob patterns
- `/for../end` loops

Templates should NOT allow:
- `/show`, `/run`, `/output`, `/var`, `/let`, or any other directive

## Impact

This is confusing and leads to unexpected behavior. Unrecognized content inside templates should be treated as **literal text** (not executed, not a parse error).

## Location

Likely in the grammar rules for template content - need to restrict what's allowed inside template wrappers.


## Notes

**2026-01-25T18:32:38Z**

## Clarification

Template content that doesn't match the allowed patterns should be treated as **plain text**, not a parse error.

So:
```mlld
var @t = :::/show {echo "OK"}:::
```

Should result in `@t` containing the literal string "/show {echo "OK"}", not executing the show directive.

Only these patterns should be interpolated:
- `@var` / `@exe(@arg)` / `@exe(@arg)|@pipe` 
- `<file.md>` / `<glob/*.md>`
- `/for../end` loops

Everything else = literal text.
