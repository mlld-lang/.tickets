---
id: m-367f
status: open
deps: []
created: 2026-02-09T22:06:28Z
type: feature
priority: 1
assignee: Adam Avenir
tags: [security, policy, operations, api-design]
updated: 2026-02-09T22:06:32Z
---
# Invert policy.operations mapping direction: risk-category → labels[]

Current policy.operations maps semantic-label → risk-category:

  operations: { "net:w": "exfil", "fs:w": "destructive" }

This is backward. Invert to risk-category → semantic-labels[]:

  operations: { exfil: ["net:w", "net:ws", "mcp:send"], destructive: ["fs:w", "fs:rm"] }

The inverted form groups by the thing you care about when writing policy. You can see at a glance everything classified as exfil.

Type change: PolicyOperations from Record<string, string> to Record<string, string[]>.

Files to change:
- core/policy/union.ts (type + normalize + merge)
- core/policy/label-flow.ts (expandOperationLabels)
- core/policy/label-flow.test.ts
- core/policy/guards.ts (passes operations through)
- docs/src/atoms/security/labels-sensitivity.md
- docs/src/atoms/security/labels-trust.md
- docs/src/atoms/security/policy-operations.md
- docs/src/atoms/security/guards-privileged.md
- docs/src/atoms/security/pattern-dual-audit.md
- llm/run/j2bd/security/impl/main.mld
- llm/run/j2bd/security/impl/defaults-rules.mld
- tests/cases/exceptions/security/* (any using operations mapping)

