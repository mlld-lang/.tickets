---
id: m-1dcd
status: open
deps: []
links: []
created: 2026-02-06T20:39:31Z
type: task
priority: 2
assignee: Adam Avenir
---
# Review: mlld init default trustedDomains — design and security implications

mlld init scaffolds every new project with:

```json
{
  "trustedDomains": [
    "raw.githubusercontent.com",
    "gist.githubusercontent.com",
    "api.github.com"
  ]
}
```

Questions to investigate:

(a) **Why is this needed?** What breaks if trustedDomains is empty or absent? Which features depend on it (remote imports, cached URLs, module registry fetches)? Is the registry fetch already handled separately from trustedDomains?

(b) **What are the implications?** Trusting raw.githubusercontent.com means any public GitHub repo can serve content that mlld will fetch without prompting. Same for gists. Is this scoped to imports only, or does it also affect `<https://...>` file loading, `import cached`, MCP fetches, etc.?

(c) **Should this be default for all projects?** Not every project needs remote imports. A project that only uses local modules and `@local/` prefixes doesn't need any trusted domains. Should mlld init ask, or should the default be empty with a comment explaining how to add them?

(d) **Conflict with security policy?** mlld has a security/labels/guards system. Does trustedDomains interact with or bypass any of that? Could a user think they have network restrictions via policy but trustedDomains quietly allows fetches? Is there a risk of confusion between trustedDomains, policy capabilities, and env network config?

Discovered during inj-defense project setup — the defaults were generated by mlld init without any prompt or explanation.

