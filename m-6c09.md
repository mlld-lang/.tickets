---
id: m-6c09
status: closed
deps: []
created: 2026-02-16T00:52:04Z
type: bug
priority: 0
assignee: Adam
updated: 2026-02-16T01:45:03Z
---
# Fix Python single-line exe syntax

## Problem

`exe @add(a, b) = py { print(int(a) + int(b)) }` produces an IndentationError at runtime. Only multiline Python format works.

## What to do

Fix the Python code generation in `interpreter/env/executors/PythonExecutor.ts` so single-line Python exe definitions work.

The generated code structure (lines 140-155 for streaming, lines 352-364 for non-streaming) is:
1. Helper functions
2. Parameter assignments
3. `\n# User code:\n` + user code

The problem is likely that the user code from a single-line `py { ... }` block is being emitted with indentation or wrapping that causes Python's IndentationError. Check what the actual generated Python looks like for a single-line case and fix the code generation to produce valid Python.

Compare with how `js { ... }` handles single-line â€” js works fine for single-line, so the pattern exists.

## Acceptance criteria

- `exe @add(a, b) = py { print(int(a) + int(b)) }` runs without error and produces correct output
- Multiline Python exe continues to work
- Add a test case for single-line Python exe in `tests/cases/`


**2026-02-16 01:45 UTC:** Fixed Python single-line exe syntax by normalizing Python user code indentation in interpreter/env/executors/PythonExecutor.ts before subprocess/shadow execution. Added regression fixture tests/cases/slash/exe/exe-py-single-line for single-line and indented multiline py blocks. Updated CHANGELOG.md (2.0.0-rc82 Fixed). Verified with npm test (4201 passed, 58 skipped). Commit: 46186ab39.
